sap.ui.define(["sap/ui/core/mvc/Controller","sap/ui/webc/main/Toast","sap/ui/core/routing/History"],function(e,t,s){"use strict";return e.extend("frontend.bbs.controller.Login",{onInit(){var e=jQuery.sap.storage(jQuery.sap.storage.Type.local);var t=e.get("jwt");this.getOwnerComponent().checkToken(t,"dashboard");var e=jQuery.sap.storage(jQuery.sap.storage.Type.local);this.domain=window.location.hostname;if(this.domain=="ess-kkb"||this.domain=="ess-bbs"){this.getView().byId("Company").setEnabled(false);if(this.domain=="ess-kkb"){this.getView().byId("Company").setSelectedKey("KKB")}else if(this.domain=="ess-bbs"){this.getView().byId("Company").setSelectedKey("BBS")}}},onLoginPressed(){let e=this.getView().byId("Company").getSelectedKey();oStore.put("company",e);let t=this.getView().byId("username").valueOf().getValue();let o=this.getView().byId("password").valueOf().getValue();let a=this.getView().byId("loginError");let i=this.getOwnerComponent().getRouter();var n,r;this.oHistory=s.getInstance();var r=oStore.get("prevHash");console.log(r);$.ajax({url:backendUrl+"login",type:"POST",data:JSON.stringify({email:t,password:o}),contentType:"application/json; charset=utf-8",dataType:"json",success:function(e){oStore.put("jwt",e.jwt);if(r!==null){window.history.go(-1)}else{i.navTo("dashboard",{},true)}},statusCode:{401:function(e,t,s){a.show()},404:function(e,t,s){a.show()}}})}})});