sap.ui.define(["sap/ui/core/mvc/Controller","sap/ui/core/routing/History","sap/ui/core/Fragment","sap/ui/layout/HorizontalLayout","sap/ui/layout/VerticalLayout","sap/m/Dialog","sap/m/Button","sap/m/Label","sap/m/library","sap/m/MessageToast","sap/m/Text","sap/m/TextArea","sap/ui/model/json/JSONModel"],function(e,t,r,n,a,o,i,s,u,l,g,c,d){"use strict";var f=u.ButtonType;var p=u.DialogType;return e.extend("frontend.bbs.controller.advanceRealization.List",{onInit:function(){this.getView().byId("advanceRealizationTableID").setBusy(true);var e=this.getRouter().getHashChanger().getHash();var t=jQuery.sap.storage(jQuery.sap.storage.Type.local);this.oJWT=t.get("jwt");var r=new d;var n=new sap.ui.model.json.JSONModel({is_approver:false});this.getView().setModel(n,"viewModel");r.loadData(backendUrl+"advanceRequest/getAdvanceRealizations",null,true,"GET",false,false,{Authorization:"Bearer "+this.oJWT});this.getView().setModel(r,"advanceRealization");r.dataLoaded().then(function(){this.getView().byId("advanceRealizationTableID").setBusy(false)}.bind(this));var a=this.getOwnerComponent().getModel("userModel");if(a===undefined){const e=this.getOwnerComponent().getEventBus();e.subscribe("username","checktoken",this.toggleCreateButton,this)}else{var o=a.getData();var i={userName:o.user.name,roleId:o.user.role_id,roleName:o.role[0].name,status:"success"};this.toggleCreateButton("username","checkToken",i)}},toggleCreateButton:function(e,t,r){if(r.roleId==4||r.roleId==5){this.getView().getModel("viewModel").setProperty("/is_approver",true)}},onCreateButtonClick:function(e){if(!this.createBudgetingDialog){this.createBudgetingDialog=this.loadFragment({name:"frontend.bbs.view.budgeting.CreateForm"})}this.createBudgetingDialog.then(function(e){this.oDialog=e;this.oDialog.open();var t=new sap.ui.model.json.JSONModel;var r=[];t.setData(r);this.getView().setModel(t,"budgetingDetailModel");this._oMessageManager.registerObject(this.oView.byId("formContainer"),true)}.bind(this))},getRouter:function(){return sap.ui.core.UIComponent.getRouterFor(this)},onNavBack:function(e){var r,n;r=t.getInstance();n=r.getPreviousHash();if(n!==undefined){window.history.go(-1)}else{this.getRouter().navTo("login",{},true)}},_closeDialog:function(){this.oDialog.close()},buttonFormatter:function(e){if(e==2||e==3){return"Accept"}else if(e==1){return"Attention"}else{return"Reject"}},objectFormatter:function(e){if(e==2||e==3){return"Success"}else if(e==1){return"Warning"}else{return"Error"}},textFormatter:function(e){if(e==1){return"Pending"}else if(e==2){return"Approved by Manager"}else if(e==3){return"Approved by Director"}else{return"Rejected"}},realizationButtonFormatter:function(e){if(e==3||e==4){return"Success"}else if(e==1||e==2){return"Warning"}else{return"Error"}},realizationObjectFormatter:function(e){if(e==1){return"Information"}else if(e==2){return"Warning"}else if(e==3||e==4){return"Success"}else{return"Error"}},relizationTextFormatter:function(e){if(e==1){return"Unrealized"}else if(e==2){return"Submitted"}else if(e==3){return"Approved by Manager"}else if(e==4){return"Approved by Director"}else{return"Rejected"}},onPress:function(e){var t=this.getOwnerComponent().getRouter();var r=e.getSource();var n=r.getCells()[0].getText();t.navTo("advanceRealizationDetail",{ID:n})},dateFormatter:function(e){var t=new Date(e);var r=sap.ui.core.format.DateFormat.getDateInstance({pattern:"YYYY-MM-dd"});var n=r.format(t);return n}})});