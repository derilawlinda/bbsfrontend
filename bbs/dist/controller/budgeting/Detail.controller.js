sap.ui.define(["sap/ui/core/mvc/Controller","sap/ui/core/routing/History","sap/ui/model/json/JSONModel"],function(e,t,o){"use strict";return e.extend("frontend.bbs.controller.budgeting.Detail",{onInit:async function(){this.currentRoute=this.getOwnerComponent().getRouter().getHashChanger().getHash();this.oStore=jQuery.sap.storage(jQuery.sap.storage.Type.local);this.oJWT=this.oStore.get("jwt");var e=this.getOwnerComponent();var t=new o(sap.ui.require.toUrl("frontend/bbs/model/sales_order.json"));this.getView().setModel(t,"salesOrder");this.oRouter=e.getRouter();this.userModel=e.getModel("userModel");this.getView().setModel(this.userModel,"userModel");this.oRouter.getRoute("budgetingDetail").attachPatternMatched(this._onObjectMatched,this);var n=new o(sap.ui.require.toUrl("frontend/bbs/model/companies.json"));this.getView().setModel(n,"companies")},_onObjectMatched:function(e){this.getView().bindElement({path:"/value/"+window.decodeURIComponent(e.getParameter("arguments").budgetID),model:"budgeting"});const t=this.getView().getModel("budgeting");var n=t.getProperty("/value/"+window.decodeURIComponent(e.getParameter("arguments").budgetID));const s=new o(n);this.getView().setModel(s,"budgetingDetailModel")},onNavBack:function(){var e=t.getInstance();var o=e.getPreviousHash();if(o!==undefined){window.history.go(-1)}else{var n=this.getOwnerComponent().getRouter();n.navTo("dashboard",{},true)}},onApproveButtonClick:function(e){var t=this.getView().byId("_IDGenText101").getText();$.ajax({type:"POST",data:{Code:t},crossDomain:true,url:backendUrl+"budget/approveBudget",success:function(e,t,o){console.log(e);console.log("Success")},error:function(e,t,o){console.log("Got an error response: "+t+o)}})},onAmountChange:function(e){const t=this.getView().getModel("budgetingDetailModel");var o=t.getData().BUDGETREQLINESCollection;let n=0;for(let e=0;e<o.length;e++){n+=o[e]["U_Amount"]}console.log(n);const s=this.getView().getModel("budgetingDetailModel");s.setProperty("/U_TotalAmount",n)}})});