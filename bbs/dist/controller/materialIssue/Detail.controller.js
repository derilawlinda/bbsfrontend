sap.ui.define(["sap/ui/core/mvc/Controller","sap/ui/core/routing/History","sap/ui/model/json/JSONModel"],function(e,t,a){"use strict";return e.extend("frontend.bbs.controller.materialIssue.Detail",{onInit:async function(){var e=this.getOwnerComponent();this.oRouter=e.getRouter();this.oRouter.getRoute("materialIssueDetail").attachPatternMatched(this._onObjectMatched,this)},_onObjectMatched:async function(e){var t=new a;this.getView().setModel(t,"viewModel");this.getView().byId("materialIssuePage").setBusy(true);var o=jQuery.sap.storage(jQuery.sap.storage.Type.local);this.oJWT=o.get("jwt");var n=new a;n.loadData(backendUrl+"checkToken",null,true,"POST",false,false,{Authorization:"Bearer "+this.oJWT});n.dataLoaded().then(function(){var e=n.getData();if(e.user.role_id==3){t.setProperty("/editable",true)}else{t.setProperty("/editable",false)}console.log(t)});this.getView().bindElement({path:"/value/"+window.decodeURIComponent(e.getParameter("arguments").ID),model:"materialIssue"});var s=e.getParameter("arguments").ID;if(s===undefined){var r=window.location.href;var i=r.split("/");s=i[i.length-1]}const l=new a;l.loadData(backendUrl+"materialIssue/getMaterialIssueById?code="+s,null,true,"GET",false,false,{Authorization:"Bearer "+this.oJWT});this.getView().setModel(l,"materialIssueDetailModel");var d=new a;d.loadData(backendUrl+"getBudget",null,true,"GET",false,false,{Authorization:"Bearer "+this.oJWT});this.getOwnerComponent().setModel(d,"budgeting");l.dataLoaded().then(function(){var e=this.getView().getModel("materialIssueDetailModel").getData();const t=new a;t.loadData(backendUrl+"budget/getBudgetById?code="+e.U_BudgetCode,null,true,"GET",false,false,{Authorization:"Bearer "+this.oJWT});this.getOwnerComponent().setModel(t,"budget");t.dataLoaded().then(function(){this.getView().byId("materialIssuePage").setBusy(false)}.bind(this))}.bind(this))},onNavBack:function(){var e=t.getInstance();var a=e.getPreviousHash();if(a!==undefined){window.history.go(-1)}else{var o=this.getOwnerComponent().getRouter();o.navTo("dashboard",{},true)}}})});