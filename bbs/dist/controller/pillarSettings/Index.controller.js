sap.ui.define(["sap/ui/core/mvc/Controller","sap/ui/model/json/JSONModel","sap/m/MessageToast","sap/m/MessageBox","sap/ui/model/FilterOperator","frontend/bbs/libs/lodash"],function(e,t,i,o,s,a){"use strict";var n=e.extend("frontend.bbs.controller.pillarSettings.Index",{_viewConfigData:{addButtonVisibility:false,removeButtonVisibility:false},onInit:function(e){this.oSemanticPage=this.byId("_IDSemanticPage1");this.oEditAction=this.byId("editAction");var i=new t(sap.ui.require.toUrl("frontend/bbs/model/pillars.json"));var o=new t(this._viewConfigData);this.getView().setModel(o,"viewConfig");i.attachRequestCompleted(null,function(){var e=i.getData();var t=this.flattenMyTree(e);var o=_.filter(t,{subheader:"Pillar"});var s=new sap.ui.model.json.JSONModel(o);this.getView().setModel(s,"pillarModel");this.getView().setModel(i)},this)},flattenMyTree:function(e){function t(e){return _.flatMap(e,function(e){return _.concat([_.assign({subheader:e.subheader,text:e.text},_.omit(e,"nodes"))],t(e.nodes))})}return t(e)},onEdit:function(){this.showFooter(true);var e=this.getView().getModel("viewConfig");e.setProperty("/addButtonVisibility",true);e.setProperty("/removeButtonVisibility",true);this.oEditAction.setVisible(false)},showFooter:function(e){this.oSemanticPage.setShowFooter(e)},onSave:function(){this.showFooter(false);this.oEditAction.setVisible(true);var e=this.getView().getModel("viewConfig");e.setProperty("/addButtonVisibility",false);e.setProperty("/removeButtonVisibility",false);o.alert("Successfully saved!")},onCancel:function(){this.showFooter(false);this.oEditAction.setVisible(true);var e=this.getView().getModel("viewConfig");e.setProperty("/addButtonVisibility",false);e.setProperty("/removeButtonVisibility",false)},addTile:function(e){var t=e.getSource().getParent().getParent().getParent();var i=t.getBindingContextPath();var o=this.getView().getModel();var s=o.getProperty(i);var a=this.getView().getModel("viewConfig");var n;if(s.subheader=="Company"){n="Pillar"}else if(s.subheader=="Pillar"){n="Classification"}else if(s.subheader=="Classification"){n="Subclass"}else if(s.subheader=="Subclass"){n="SubClass2"}a.setProperty("/windowText",n);if(!this.createTileDialog){this.createTileDialog=this.loadFragment({name:"frontend.bbs.view.pillarSettings.addNode"})}this.createTileDialog.then(function(e){this.oDialog=e;this.oDialog.open()}.bind(this));var r=[];if(s.nodes!==undefined){r=s.nodes}else{s.nodes=r}var l={text:"New",subheader:"New 1",is_editable:true};r.push(l);o.setProperty(i,s)},_closeDialog:function(){this.oDialog.close()},removeTile:function(e){var t=e.getSource().getParent().getParent().getParent();var i=t.getBindingContextPath();var o=this.getView().getModel();var s=o.getProperty(i);var a=o.getData();this._deleteRecord(a,s);o.setData(a)},_deleteRecord:function(e,t){if(e!==undefined){for(var i=0;i<e.length;i++){if(e[i]===t){e.splice(i,1);break}else{this._deleteRecord(e[i].nodes,t)}}}},handleButtonPress:function(e){i.show("Button pressed")}});return n});